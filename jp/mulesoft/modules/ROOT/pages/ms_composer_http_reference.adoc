= HTTP Connector リファレンス

HTTP Connector は、専用のコネクタで現在サポートされていないクラウドアプリケーションを接続します。HTTP Connector を使用して、コンポーザで現在サポートされていないシステムに接続し、コンポーネントでサポートされていないシステムの機能を拡張します。HTTP Connector for Composer は、 https://www.digitalocean.com/community/tutorials/http-1-1-vs-http-2-what-s-the-difference#http-1-1[HTTP]​ 1.1 を使用して JSON データを処理します。

== Connections (接続)

システムに接続するには、システムがデータの取得元であるか、データの取得先であるかに関係なく、そのシステムの必要なログイン情報を使用して接続を作成する必要があります。通常、フロー内の異なるシステムに接続し、接続が必要になるたびに各接続を再利用できます。

次の接続情報を入力します。

include::_partials/connection-name.adoc[]

ベース URL::

接続で使用するクラウドアプリケーションのデフォルトの場所の URL。

Authorization (認証)::

次の認証オプションを使用できます。

* *OAuth 2.0 Client Credentials (OAuth 2.0 クライアントログイン情報)* +
  OAuth 2.0 クライアントログイン情報では、ユーザ定義パスからアクセストークンが取得されます。次の項目の値を指定します。
  ** *Base URL (ベース URI)*​
  ** *Client ID (クライアント ID)*​
  ** *Client Secret (クライアントシークレット)*​
  ** *Token URL (トークン URL)*

* *API キー* +
  API キーは、ユーザを明示的に定義せずにアプリケーションに接続します。このキーをすべての要求に追加する必要があります。クラウドアプリケーションは、要求元を識別して認証を完了します。次の項目の値を指定します。
  ** *Base URL (ベース URI)*​
  ** *Name (名前)*​
  ** *値*​
  ** *Sent As (送信形式)*​: 次のいずれかの値を選択します。
    *** *Header (ヘッダー)*​: 選択した場合、コンポーザは ​`Name: Value`​ というヘッダーを要求に追加します。
    *** *Query Parameter (クエリパラメータ)*​: 選択した場合、コンポーザは ​`Name=Value`​ というクエリパラメータを要求に追加します。

* *基本認証* +
  基本認証メソッドを使用すると、HTTP ユーザエージェントは HTTP 要求を行うときにユーザ名とパスワードを指定できます。次の項目の値を指定します。
  ** *Base URL (ベース URI)*​
  ** *Username (ユーザ名)*​
  ** *Password (パスワード)*

* *Bearer Token Authorization (ベアラートークン認証)*
  ベアラートークン認証は、​`Bearer`​ という値とトークンが含まれる ​`Authorization`​ というヘッダーを要求ごとに送信する認証プロセスです。次の項目の値を指定します。
  ** *Base URL (ベース URI)*​
  ** *Token (トークン)*

=== 接続をテストする

接続方法を確立したら、接続をテストできます。他のコネクタはコンポーザによってバックグラウンドで自動的にテストされますが、HTTP Connector はテストする必要があります。テストで使用するページを決定できます。接続は後で編集できないため、接続のテストは重要です。

接続をテストするには、次の項目の値を入力します。

* *Request Method (要求方法)*​
* *Request Path (要求パス)*​: この項目の値はベース URL に対して相対的です。
* *Request Headers (リクエストヘッダー)*​
  ** *Key (キー)*​
  ** *値*​
* *Request Body (リクエストボディ)*​: このオプションは、HTTP メソッドが POST で、要求メッセージの本文である場合に表示されます。

*[Connect (接続)]*​ をクリックして接続をテストします。接続が正常に作成されたことを示すメッセージ (応答コード ​`200`​) またはエラーが発生したことを示すメッセージが表示されます。

データを処理するためにトークンをエクスチェンジすることがアプリケーションで求められる場合、ユースケースごとにトークンを作成する必要があります。たとえば、Salesforce Marketing Cloud では、フロー 1 の最初のステップでトークンが生成され、このトークンがフロー 2 の同様のステップで無効になる可能性があるため、これが必要になります。

== HTTP Connector の項目

HTTP Connector に適用される項目は、次のとおりです。

[%header%autowidth.spread]

|===

|名前 |型 |説明

|Relative URL (相対 URL) |String (文字列) |ベースパスを考慮しない、要求の対象の URL。

|アクション |String (文字列) |要求の種別。​*[Request (要求)]*​ と ​*[Paginated Request (ページ分割された要求)]*​ のいずれかを選択する必要があります。


|HTTP メソッド |String (文字列) a|要求の HTTP メソッド。次の HTTP メソッドを使用できます。

* *GET*​: サーバから情報を取得します。
* *POST*​: サーバに情報を送信します。
* *PUT*​: サーバの既存のレコードの情報を更新します。
* *PATCH*​: サーバの既存のレコードの特定のデータを更新します。
* *DELETE*​: サーバの既存のレコードの情報を削除します。

|*Path (パス)* |String (文字列) |アクセスするサーバの特定のリソースを識別します。

|*Header (ヘッダー)* |Object (オブジェクト) |ユーザやサーバが HTTP 要求または応答で追加情報を渡すことができるようにします。大文字と小文字を区別しない名前 (キー)、コロン、値の順で構成されます。ヘッダーを追加する場合、​*[Key (キー)]*​ および ​*[Value (値)]*​ 項目の値を入力する必要があります。

|*Query Parameters (クエリパラメータ)* |Object (オブジェクト) |要求に含めるクエリパラメータ。クエリパラメータを追加する場合、​*[Key (キー)]*​ および ​*[Value (値)]*​ 項目の値を入力する必要があります。

|*Example Request (サンプル要求)* |String (文字列) |JSON 形式のサンプル要求。この項目の値を入力すると、コンポーザはサンプルを解析して、その項目を推定します。その後、その項目を使用してデータを入力し、要求の操作を設定できます。

|*Example Response (サンプル応答)* |String (文字列) |JSON 形式のサンプル応答。この項目の値を入力すると、コンポーザはサンプル JSON ペイロードを解析して、JSON 項目に一致するデータピルを提供します。

|*Array Path (配列パス)* |String (文字列) |JSON 配列へのパス。​*[Array Path (配列パス)]*​ 項目の値はデフォルトで選択されていますが、ドロップダウンから別の値を選択できます。この値が表示されるのは、​*[Action (アクション)]*​ 項目の値が ​*[Paginated Request (ページ分割された要求)]*​ に設定されている場合のみです。

|*Pagination Type (ページネーション種別)* |String (文字列) |要求のページネーションの種別。次のページネーション種別が使用できます。

* *Page Number (ページ番号)*​: この値を選択する場合は、​*[Page Number Parameter Name (ページ番号のパラメータ名)]*​ 項目の値を指定します。
* *Marker (マーカー)*​: この値を選択する場合は、​*[Marker Parameter Name (マーカーのパラメータ名)]*​ 項目の値を指定します。
* *Marker (マーカー)*​: この値を選択する場合は、​*[Marker Parameter Name (マーカーのパラメータ名)]*​ 項目の値を指定します。
* *Link Header (リンクヘッダー)*​: この値を選択する場合は、​*[Link Relation (リンクリレーション)]*​ 項目の値を指定します。

|*Maximum Number of Pages (ページの最大数)* |Number (数値) |要求で API から返されるページの最大数。

|===

== アクション

include::_partials/action-definition.adoc[]

HTTP の要求::
*[Action (アクション)]*​ 項目で ​*[Request (要求)]*​ が選択されている場合、HTTP の要求によって応答ペイロードの項目が返されます。次の項目では、値は必須です。

* *Action (アクション)*​
* *HTTP メソッド*​
* *Path (パス)*​
* *Example Response (サンプル応答)*​
* 必要に応じて ​*[Add Query Parameters (クエリパラメータを追加)]*​ をクリックした場合、次の項目の値を入力する必要があります。
  ** *Key (キー)*​
  ** *値*​
* 必要に応じて ​*[Add Headers (ヘッダーを追加)]*​ をクリックした場合、次の項目の値を入力する必要があります。
  ** *Key (キー)*​
  ** *値*

HTTP のページ分割された要求::
*[Action (アクション)]*​ 項目で ​*[Paginated Request (ページ分割された要求)]*​ が選択されている場合、ページ分割された HTTP 要求が開始されます。ページ分割された要求により、以降のフローステップが For Each ループで使用できる項目のリストが返されます。コンポーザでは、自動的にページネーション設定を使用して API からデータがフェッチされます。次の項目では、値は必須です。

* *Action (アクション)*​
* *HTTP メソッド*​
* *Path (パス)*​
* *Example Response (サンプル応答)*​
* *Array Path (配列パス)*​
* *Pagination Type (ページネーション種別)*​
* 必要に応じて ​*[Add Query Parameters (クエリパラメータを追加)]*​ をクリックした場合、次の項目の値を入力する必要があります。
  ** *Key (キー)*​
  ** *値*​
* 必要に応じて ​*[Add Headers (ヘッダーを追加)]*​ をクリックした場合、次の項目の値を入力する必要があります。
  ** *Key (キー)*​
  ** *値*

include::_partials/see-also.adoc[]
